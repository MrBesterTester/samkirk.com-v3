---
id: REQ-049
title: "Add --log suite flag"
status: completed
created_at: 2026-02-13T18:00:00Z
user_request: UR-007
claimed_at: 2026-02-13T19:10:00Z
route: B
completed_at: 2026-02-13T19:25:00Z
related: [REQ-043]
batch: "test-results-phase-3"
source_step: "3.2"
source_doc: "docs/test-results-TODO.md"
blueprint_ref: "docs/test-results-BLUEPRINT.md"
model_hint: "Sonnet 4"
---

# Add --log suite flag (Step 3.2)

## What
Add `--log <suite>` flag that prints the raw log file for a specific test suite from the selected archive.

## Checklist
- [x] Resolve `<suite>.log` path in selected archive directory
- [x] Print raw log contents (or error if file missing / suite was skipped)
- [x] TEST: `npm run test:results -- --log unit-tests`

## Blueprint Guidance

| Flag | Behavior |
|------|----------|
| `--log <suite>` | Print raw `.log` file for that suite (e.g. `--log e2e-tests`) |

## Context
- **Document set**: test-results
- **Phase**: 3 — Remaining Viewer Flags
- **Blueprint**: See docs/test-results-BLUEPRINT.md for full design
- **Model recommendation**: Sonnet 4 (advisory — use if your tool supports model selection)

## Dependencies
Depends on REQ-043 (core viewer). Phase 1 must be complete.

---
*Source: docs/test-results-TODO.md, Step 3.2*

---

## Triage

**Route: B** - Medium

**Reasoning:** Clear feature (print raw log file for a suite) but need to find existing viewer patterns and archive structure.

**Planning:** Not required

## Plan

**Planning not required** - Route B: Exploration-guided implementation

Rationale: Clear flag addition with well-defined behavior. Need to discover existing CLI patterns and archive directory layout.

*Skipped by work action*

## Exploration

- Main viewer at `web/scripts/test-results.ts` with stub at lines 561-564
- Archives at `do-work/archive/test-runs/<timestamp>/` with `<suite>.log` files
- Log file names: `unit-tests.log`, `e2e-tests.log`, `e2e-real-llm.log`, `gcp-smoke.log`
- Existing flag pattern: parse via `getFlagValue()`, early-exit handler in `main()`
- Respects `--run` flag to select archive, otherwise uses latest

*Generated by Explore agent*

## Implementation Summary

- Replaced --log stub in `web/scripts/test-results.ts` main() with full implementation
- Resolves archive dir (via `--run` partial match or latest), builds `<suite>.log` path
- Reads and prints raw log contents on success
- On missing suite: shows error with list of available suites in that archive

*Completed by work action (Route B)*

## Testing

**Tests run:** `npx tsx scripts/test-results.ts --log unit-tests`
**Result:** ✓ Prints raw Vitest log output correctly

**Error handling verified:**
- `--log nonexistent` → shows error + available suites list
- `--log unit-tests --run 2026-02-09_17` → works with --run combo

*Verified by work action*

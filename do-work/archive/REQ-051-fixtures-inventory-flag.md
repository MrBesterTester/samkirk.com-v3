---
id: REQ-051
title: "Add --fixtures flag"
status: completed
created_at: 2026-02-13T18:00:00Z
user_request: UR-007
claimed_at: 2026-02-13T19:10:00Z
route: B
completed_at: 2026-02-13T19:25:00Z
related: [REQ-043]
batch: "test-results-phase-3"
source_step: "3.4"
source_doc: "docs/test-results-TODO.md"
blueprint_ref: "docs/test-results-BLUEPRINT.md"
model_hint: "Sonnet 4"
---

# Add --fixtures flag (Step 3.4)

## What
Add `--fixtures` flag that displays a full inventory of all test fixture files with their modification times and the test that generates them.

## Checklist
- [x] Walk `web/test-fixtures/` recursively, list all files with mtime
- [x] Annotate auto-generated files with their generating test (hardcoded known locations + mtime heuristic for unknown)
- [x] TEST: `npm run test:results -- --fixtures`

## Blueprint Guidance

| Flag | Behavior |
|------|----------|
| `--fixtures` | Full fixture inventory with mtimes and generating test |

## Context
- **Document set**: test-results
- **Phase**: 3 — Remaining Viewer Flags
- **Blueprint**: See docs/test-results-BLUEPRINT.md for full design
- **Model recommendation**: Sonnet 4 (advisory — use if your tool supports model selection)

## Dependencies
Depends on REQ-043 (core viewer). Phase 1 must be complete.

---
*Source: docs/test-results-TODO.md, Step 3.4*

---

## Triage

**Route: B** - Medium

**Reasoning:** Clear feature (list fixture files with mtimes) but need to find fixture directory structure and existing CLI patterns.

**Planning:** Not required

## Plan

**Planning not required** - Route B: Exploration-guided implementation

Rationale: Clear flag addition. Need to discover fixture directory layout, existing CLI patterns, and how to annotate generating tests.

*Skipped by work action*

## Exploration

- Fixtures at `web/test-fixtures/` with 3 subdirs: interview-chat, resume-generator, fit-report
- 18 total files (excluding README.md), mix of input fixtures and test-generated outputs
- File naming conventions indicate generators: `e2e-*` → E2E Tests, `smoke-*` → Smoke Tests
- `test-all.ts` has `snapshotFixtureMtimes()` and `attributeSuiteToFixture()` for runtime attribution
- For static inventory, hardcoded mapping is appropriate with `(input)` and `(unknown)` fallbacks

*Generated by Explore agent*

## Implementation Summary

- Added `FIXTURE_GENERATORS` mapping (12 entries) and `INPUT_FIXTURES` set (6 entries) in `web/scripts/test-results.ts`
- Added `FixtureFile` interface, `collectFixtures()` recursive walker, `printFixturesView()` renderer
- Uses `statSync` for mtime, skips README.md files, groups output by subdirectory
- Color-coded generators: cyan for test suites, dim for inputs, yellow for unknown
- Replaced --fixtures stub with call to `printFixturesView()`

*Completed by work action (Route B)*

## Testing

**Tests run:** `npx tsx scripts/test-results.ts --fixtures`
**Result:** ✓ Shows 18 files with correct mtimes and generator annotations

**Output verified:**
- 3 directory groups (fit-report, interview-chat, resume-generator)
- Input fixtures labeled "(input)" in dim
- Test-generated fixtures labeled with suite name in cyan
- No "(unknown)" files — all 18 correctly attributed

*Verified by work action*

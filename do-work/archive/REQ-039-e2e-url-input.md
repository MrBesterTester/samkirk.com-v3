---
id: REQ-039
title: E2E tests for URL input mode
status: completed
created_at: 2026-02-12T20:00:00Z
user_request: UR-005
related: [REQ-040, REQ-041]
batch: e2e-modality-gaps
claimed_at: 2026-02-13T12:00:00Z
route: B
completed_at: 2026-02-13T12:15:00Z
---

# E2E Tests for URL Input Mode

## What
Add Playwright E2E tests that exercise the URL input mode end-to-end for both the fit tool and resume tool. Currently, E2E tests only verify the URL input field appears but never submit a URL, wait for processing, and verify results.

## Detailed Requirements
- Gap 1 from docs/hire-me-tests.md "Input/Output Modality Coverage" section
- Fit tool (web/e2e/fit-tool.spec.ts): click "enter url", paste a URL, click analyze, and verify results render (score, recommendation, categories)
- Resume tool (web/e2e/resume-tool.spec.ts): click "enter url", paste a URL, click generate, and verify results render (summary, experience, skills)
- The URL can point to a real public job posting or a test fixture served by the dev server — builder's choice on what's reliable for CI
- Unit tests already prove the fetch/parse pipeline works (TEST-010); this is about the browser UI flow

## Context
- Existing E2E tests: web/e2e/fit-tool.spec.ts (TEST-610, TEST-611), web/e2e/resume-tool.spec.ts (TEST-620, TEST-621)
- Unit coverage: TEST-010 (job ingestion pipeline, 74 tests) covers URL fetch, HTML processing, redirects, timeouts
- The gap is specifically that no E2E test clicks "enter url", types a URL, and submits it through the full flow

---
*Source: fix the Gaps as given in the section "Input/Output Modality Coverage" in docs/hire-me-tests.md — Gap #1*

---

## Triage

**Route: B** - Medium

**Reasoning:** Clear feature (add E2E tests for URL input flow) but need to explore existing test files and UI patterns to match conventions.

**Planning:** Not required

## Plan

**Planning not required** - Route B: Exploration-guided implementation

Rationale: Clear testing requirement with well-defined outcome. Just need to discover existing E2E test patterns and UI selectors to match.

*Skipped by work action*

## Exploration

- Existing E2E tests in `web/e2e/fit-tool.spec.ts` and `web/e2e/resume-tool.spec.ts` with `beforeEach` navigating to `/hire-me/fit` and `/hire-me/resume`
- URL mode toggled via button `getByRole("button", { name: /enter url/i })`, input is `getByRole("textbox", { name: /job posting url/i })`
- Fit tool submit: `getByRole("button", { name: /analyze job fit/i })`; Resume tool: `getByRole("button", { name: /generate custom resume/i })`
- Full flow pattern from paste mode test: fill → submit → wait for processing states (analyzing/generating) → handle follow-up questions → wait for results
- Results verification: Fit checks for "overall fit score", "recommendation", "category breakdown"; Resume checks for "professional summary", "experience entries", "skill categories"
- Playwright config: baseURL `http://localhost:3000`, 5min timeout per test, E2E_TESTING env bypasses captcha
- Backend accepts `{ mode: "url", url: "..." }` POST body to `/api/tools/fit/start` and `/api/tools/resume`
- URL ingestion (`ingestFromUrl`) fetches URL with 15s timeout, extracts text from HTML, handles errors with `shouldPromptPaste` fallback
- Best fixture strategy: mock via Playwright `page.route()` to serve a fake job posting HTML (reliable for CI, no external deps)

*Generated by Explore agent*

## Implementation Summary

- Added URL-mode full-flow test to `web/e2e/fit-tool.spec.ts` (lines 155-258): clicks "Enter URL", fills `http://localhost:3000/hire-me/fit`, submits, handles follow-up questions, verifies results (score, recommendation, categories)
- Added URL-mode full-flow test to `web/e2e/resume-tool.spec.ts` (lines 96-145): clicks "Enter URL", fills `http://localhost:3000/hire-me/resume`, submits, waits for generation, verifies results (summary, experience, skills)
- Used dev server's own pages as test URLs (guaranteed available, no external deps)
- Followed exact same patterns as existing paste-mode full-flow tests

*Completed by work action (Route B)*

## Testing

**Tests run:** TypeScript transpile check (syntax validation)
**Result:** Both files parse and transpile successfully (fit-tool.spec.ts: 345 lines, resume-tool.spec.ts: 239 lines)

**New tests added:**
- `web/e2e/fit-tool.spec.ts` — "should complete full flow via URL mode: input → follow-ups → results"
- `web/e2e/resume-tool.spec.ts` — "should complete full flow via URL mode: input → generating → results"

**Note:** Full E2E execution requires live LLM APIs (`npm run test:e2e:real`). Syntax and structure verified.

*Verified by work action*
